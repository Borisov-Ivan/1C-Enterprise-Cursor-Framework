# Стандарт использования функциональных опций

**Версия:** 1.0  
**Приоритет:** Высокий  
**Источник:** Раздел "Использование функциональных опций" (строки 220-325)

---

## Описание

Функциональные опции предназначены для управления доступностью необязательной функциональности конфигурации на стадии внедрения. Функциональные опции могут влиять на бизнес-логику и пользовательский интерфейс.

---

## Правила

### Правило 1: Назначение функциональных опций

**Критично:** Функциональные опции применяются для управления доступностью необязательной функциональности конфигурации на стадии внедрения. Для хранения значений функциональных опций в информационной базе необходимо завести в конфигурации соответствующие данные (например, константы).

```bsl
// Пример: Функциональная опция для версионирования объектов
// 1. Создать функциональную опцию ИспользоватьВерсионированиеОбъектов
// 2. Создать константу ИспользоватьВерсионированиеОбъектов типа Булево
// 3. В свойстве Хранение функциональной опции указать константу

// Использование в коде:
ИспользуетсяМеханизмВерсионирования = ПолучитьФункциональнуюОпцию("ИспользоватьВерсионированиеОбъектов");
```

**Источник:** Раздел "Использование функциональных опций", пункт 1.1

---

### Правило 2: Функциональные опции с параметрами

**Критично:** Доступность функциональности может задаваться не только для информационной базы в целом, но и в зависимости от контекста применения этой функциональности.

```bsl
// Пример: Функциональная опция с параметром Организация
// 1. Создать функциональную опцию УчетнаяПолитикаСложныйУчетНДС
// 2. Создать параметр функциональной опции Организация
// 3. Создать регистр сведений УчетнаяПолитикаНалоговыйУчет с измерением Организация
// 4. В свойстве Хранение функциональной опции указать ресурс регистра

// Установка параметров функциональной опции в форме:
УстановитьПараметрыФункциональныхОпцийФормы(Новый Структура("Организация", ТребуемаяОрганизация));

// Получение значения функциональной опции с параметрами:
ПараметрыУчетнойПолитики = Новый Структура("УчетнаяПолитикаОрганизация", ТребуемаяОрганизация);
СложныйУчетНДС = ПолучитьФункциональнуюОпцию("УчетнаяПолитикаСложныйУчетНДС", ПараметрыУчетнойПолитики);
```

**Источник:** Раздел "Использование функциональных опций", пункт 1.2

---

### Правило 3: Запрет использования функциональных опций не по назначению

**Критично:** Не следует использовать функциональные опции не по назначению:

- ❌ **НЕПРАВИЛЬНО:** Создавать функциональные опции ради управления видимостью элементов управления конкретной формы
- ✅ **ПРАВИЛЬНО:** Использовать функциональные опции для управления доступностью функциональности для всей конфигурации

- ❌ **НЕПРАВИЛЬНО:** Использовать функциональные опции для оптимизации доступа к данным
- ✅ **ПРАВИЛЬНО:** Для оптимизации доступа к данным использовать модули с повторным использованием возвращаемых значений

**Источник:** Раздел "Использование функциональных опций", пункт 1.3

---

### Правило 4: Установка значений функциональных опций

**Критично:** Платформа не предоставляет специальных средств для установки значений функциональных опций. Установка значений производится установкой значений соответствующих констант, редактированием элементов справочников или записей регистров сведений. В конфигурации следует предусмотреть соответствующую функциональность.

**Источник:** Раздел "Использование функциональных опций", пункт 2.1

---

### Правило 5: Работа с периодическими регистрами сведений

**Критично:** Если функциональная опция «привязана» к ресурсу периодического регистра сведений, то система использует срез последних для получения значения опции. Если требуется получать значение опции на какую-либо другую дату, необходимо указать значение для параметра функциональной опции Период типа Дата.

```bsl
// Установка параметра Период для периодического регистра:
УстановитьПараметрыФункциональныхОпцийФормы(
    Новый Структура("Организация, Период", ТребуемаяОрганизация, НачалоМесяца(ТребуемаяДата))
);
```

**Важно:** Значение параметра Период необходимо предварительно привести к интервалу периодичности регистра. Параметр Период не следует создавать в метаданных, так как он предоставляется системой автоматически.

**Источник:** Раздел "Использование функциональных опций", пункт 2.3

---

### Правило 6: Обновление интерфейса после изменения функциональных опций

**Критично:** Установка значения функциональной опции не вызывает автоматического изменения пользовательского командного интерфейса. Для отработки изменения следует вызвать метод `ОбновитьИнтерфейс`.

**Источник:** Раздел "Использование функциональных опций", пункт 2.4

---

### Правило 7: Ограничения на параметризацию функциональных опций

**Критично:** По соображениям производительности не рекомендуется заводить в конфигурации более 10 параметров функциональных опций. Не рекомендуется параметризовать функциональные опции такими данными, которые заведомо могут иметь большое число значений (например, контрагентами или товарами).

```bsl
// ❌ НЕПРАВИЛЬНО: Параметризация контрагентом
ФункциональнаяОпция.Параметр = Контрагент; // Может быть много контрагентов

// ✅ ПРАВИЛЬНО: Параметризация видом контрагента
ФункциональнаяОпция.Параметр = ВидКонтрагента; // Видов контрагентов немного
```

**Источник:** Раздел "Использование функциональных опций", пункт 2.5

---

### Правило 8: Зависимые функциональные опции

**Критично:** В случаях сложной зависимости значения функциональной опции от значений других функциональных опций необходимо обеспечить непротиворечивость данных, связанных с функциональными опциями.

```bsl
// Пример: Функциональная опция "перевод сотрудников" зависит от 
// "многофирменный учет" И "кадровый учет"
// Необходимо:
// 1. Создать функциональную опцию "ПереводСотрудников"
// 2. Обеспечить зависимость значения от других опций при записи констант
// 3. В форме настроек значение "ПереводСотрудников" должно быть недоступно для редактирования
```

**Источник:** Раздел "Использование функциональных опций", пункт 3.1

---

### Правило 9: Ограничение количества параметров функциональных опций

**Критично:** По соображениям производительности не рекомендуется заводить в конфигурации более 10 параметров функциональных опций. Не следует создавать различные параметры функциональных опций одной смысловой нагрузки.

```bsl
// ❌ НЕПРАВИЛЬНО: Два параметра одной смысловой нагрузки
ТипВерсионируемогоОбъекта // для регистра НастройкаВерсионированияОбъектов
ТипОбъектаСДополнительнымиОтчетамиИОбработками // для регистра НазначениеДополнительныхОбработок

// ✅ ПРАВИЛЬНО: Один параметр для обоих регистров
ТипОбъектаКонфигурации // связан с измерениями обоих регистров
```

**Источник:** Раздел "Использование функциональных опций", пункт 4.1

---

## Чек-лист проверки

- [ ] Функциональные опции используются только для управления доступностью функциональности
- [ ] Для хранения значений функциональных опций созданы соответствующие данные (константы, регистры)
- [ ] Функциональные опции не используются для управления видимостью элементов конкретной формы
- [ ] Функциональные опции не используются для оптимизации доступа к данным
- [ ] После изменения функциональных опций вызывается метод `ОбновитьИнтерфейс`
- [ ] Количество параметров функциональных опций не превышает 10
- [ ] Параметры функциональных опций не параметризуются данными с большим числом значений
- [ ] Зависимые функциональные опции настроены корректно
- [ ] Не создаются различные параметры функциональных опций одной смысловой нагрузки

---

**Ссылка на исходный документ:** Раздел "Использование функциональных опций" (строки 220-325)

